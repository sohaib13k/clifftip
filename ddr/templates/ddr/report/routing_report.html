<div class="card">
  <div class="card-header">
    <h5 class="card-title">Routing Report</h5>
  </div>
  <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
    <table class="table table-striped table-bordered table-sm">
        <tr>
          <th>Date</th>
          {% for item in result.routing_report.items%}
            <td class="text-end" style="white-space: nowrap;">{{ item.report_upload_date }}</td>
          {% endfor %}
        </tr>
        <tr>
          <th style="white-space: nowrap;">Lock/Total</th>
          {% for item in result.routing_report.items%}
            <td class="text-end" style="white-space: nowrap;">{{ item.data_lock }} / {{ item.total }}</td>
          {% endfor %}
        </tr>
        <tr>
          <th>Percentage</th>
          {% for item in result.routing_report.items%}
            <td class="text-end" style="white-space: nowrap;">{{ item.data_lock_percent|floatformat:2 }}%</td>
          {% endfor %}
          <td>
            <div style="height:25px;">
                <canvas id="routing-chart-percentage-trend"></canvas>
            </div>
        </td>
        </tr>
    </table>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
      var ctx = document.getElementById('routing-chart-percentage-trend').getContext('2d');
      var dataLockPercent = [
          {% for item in result.routing_report.items %}
              {{ item.data_lock_percent|floatformat:2 }},
          {% endfor %}
      ];

      var chart = new Chart(ctx, {
          type: 'line',
          data: {
              labels: dataLockPercent.map((_, index) => index + 1), // Adding labels to avoid undefined issue
              datasets: [{
                  data: dataLockPercent,
                  borderColor: 'rgba(0, 123, 255, 1)',
                  borderWidth: 1,
                  fill: false,
                  pointBackgroundColor: 'rgba(120, 120, 120, 1)', // Color for highlighted points
                  pointBorderColor: 'rgba(255, 0, 0, 0)', // Border color for highlighted points
                  pointRadius: 2 // Size of highlighted points
              }]
          },
          options: {
            legend: {
              display: false
          },
          tooltips: {
              enabled: false
          },
            scales: {
              xAxes: [{
                ticks: {
                  display: false //this will remove only the label
              },
                  gridLines: {
                      display:false
                  }
              }],
              yAxes: [{
                ticks: {
                  display: false //this will remove only the label
              },
                  gridLines: {
                      display:false
                  }   
                }]
              },
              plugins: {
                  legend: {
                      display: false // Hide the legend
                  }
              },
              elements: {
                  point: {
                      radius: 0 // Highlight data points
                  },
                  line: {
                      tension: 0 // Add some curve to the line
                  }
              },
              responsive: true,
              maintainAspectRatio: false,
              animation: false
          }
      });
  });
</script>