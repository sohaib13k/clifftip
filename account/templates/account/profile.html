{% extends "commonutil/base.html" %}
{% load static %}

{% block title %} Upload Report | Clifftip {{ result.report.name }} {% endblock %}

{% block content %}
	<div class="wrapper">
	
		{% include 'commonutil/sidebar.html' %}
		
		<div class="main">
  		{% include 'commonutil/navbar.html' %}

			<main class="content">
				<div class="container-fluid p-0">

					<h1 class="h3 mb-3">Profile</h1>

						<div class="col-md-4 col-xl-3">
							<div class="card mb-3">
								<div class="card-header">
									<h5 class="card-title mb-0">Profile Details</h5>
								</div>
								<div class="card-body text-center">
									<img src={% static 'img/avatars/avatar.svg' %} alt={{ request.user.username }} class="img-fluid rounded-circle mb-2" width="128" height="128" />
									<h5 class="card-title mb-0">{{request.user.username }}</h5>
									<div class="text-muted mb-2">{% if request.user.is_superuser %} Administrator {% else %} Staff {% endif %}</div>
								</div>
								<hr class="my-0" />
								<div class="card-body">
									<h5 class="h6 card-title">Responsibilities</h5>
									<a href="#" class="badge bg-primary me-1 my-1">HTML</a>
									<a href="#" class="badge bg-primary me-1 my-1">HTML</a>
									<a href="#" class="badge bg-primary me-1 my-1">HTML</a>
									<a href="#" class="badge bg-primary me-1 my-1">HTML</a>
									<a href="#" class="badge bg-primary me-1 my-1">UI</a>
									<a href="#" class="badge bg-primary me-1 my-1">UX</a>
								</div>
								<hr class="my-0" />
								<div class="card-body">
									<h5 class="h6 card-title">Color theme</h5>
									<form id="colorThemeForm" class="form-inline">
										{% csrf_token %}
										<div class="form-group mb-2">
											<label for="colorTheme" class="mr-2">Select Theme:</label>
											<select class="form-control mr-2" id="color_theme" name="color_theme">
												<option value="default" {% if theme == "default" %}selected{% endif %}>Default</option>
												<option value="light" {% if theme == "light" %}selected{% endif %}>Light</option>
												<option value="dark" {% if theme == "dark" %}selected{% endif %}>Dark</option>
												<option value="colored" {% if theme == "colored" %}selected{% endif %}>Colored</option>
											</select>
										</div>
										<button type="button" class="btn btn-primary mb-2" onclick="submitForm()">Submit</button>
									</form>

								</div>
								
							</div>

						
					</div>

				</div>
			</main>

			
		</div>
	</div>

	<script>
		function submitForm() {

			const form = document.getElementById('colorThemeForm');
			const formData = new FormData(form);
			const data = {};
			formData.forEach((value, key) => {
				data[key] = value;
			});
		
			fetch("{% url 'change_color_theme' %}", {
				method: "POST",
				headers: {
					"Content-Type": "application/json",
					"X-CSRFToken": form.querySelector('[name=csrfmiddlewaretoken]').value
				},
				body: JSON.stringify(data)
			})
			.then(response => response.json())
			.then(data => {
				if (data.message) {
					showSuccessAlert(data.message);
				}
			})
			.catch((error) => {
				console.error('Error:', error);
			});
		}

		function showSuccessAlert(message) {
			const alertContainer = document.createElement('div');
			alertContainer.className = 'alert alert-success alert-dismissible';
			alertContainer.role = 'alert';
		
			const closeButton = document.createElement('button');
			closeButton.type = 'button';
			closeButton.className = 'btn-close';
			closeButton.setAttribute('data-bs-dismiss', 'alert');
			closeButton.setAttribute('aria-label', 'Close');
		
			const alertMessage = document.createElement('div');
			alertMessage.className = 'alert-message';
			alertMessage.innerHTML = `<strong>Success!</strong> ${message}`;
		
			alertContainer.appendChild(closeButton);
			alertContainer.appendChild(alertMessage);
		
			const mainContent = document.querySelector('main .container-fluid');
			mainContent.insertBefore(alertContainer, mainContent.firstChild);
		}
	</script>

{% endblock %}